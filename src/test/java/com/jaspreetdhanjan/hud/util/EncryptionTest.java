package com.jaspreetdhanjan.hud.util;

import org.junit.Test;

import static org.junit.Assert.*;

public class EncryptionTest {
	private final String password = "hud123javaSpaceisthebest96";

	@Test
	public void testEncryption() throws Exception {
		String encryptedPassword = Encryption.encryptString(password);
		String[] hash = encryptedPassword.split(":");

		System.out.println(encryptedPassword);

		assertNotEquals("Encryption method should not return the field.", password, encryptedPassword);
		assertEquals("Hash has three components", 3, hash.length);
		assertEquals("Iterations should be 5000", 5000, Integer.valueOf(hash[1]).intValue());
	}

	@Test
	public void testValidation() throws Exception {
		// To speed this up, we use an already hashed string that we might find in our JavaSpace
		final String encryptedPassword = "5e4682898e6dce60d5b30d50aefcc58975a6a3bd0d9b34197c1d45043b854185591413f03e76c4d2bbdbdeb6f49c63c6394b63b24faef7b2af0061f9f8f09d3e385cdfb01d14dca2c7e728ab0dada34279d166d8df988bf572f455a809ab0b6e3154f233ae1a4fd72ffc6039c5e5565c1dc43192b707fcce9dec850299790bceae7d87e6c206a4487649ba8cbc4432f5da33984a602e074c137024a01b500b3bee61e345f397ed56b8c640bfdac1564c850f540f02f719ce9dfdb44221d43e20941712305bfbd6a1535de7a42f0baae29c48229e89173ca0b5062dbad420184e46f781b06f9d2dd5e9bababb2104fb60429ae69fac38d85a1d3390fa4419b491606e4931945e07bf89abeb5de4d31b4392fa5bd0f3ad11ef29f878d7ac628a5270498d34300f1e07db817bad7245047b94fe57a5ee56fba5c5233dd579f81a7b7bbb4a79148e4f68c4488c6e6352480399dd4f1dfef7ede3b77fe51a3c06f45dd28f5edaef89b82d42fa983f5a46c21f62b9999de085a45b851bcf7ef69f77ef351d78751e774488396612ce0c9ff694f6596c9f9555badda157ef6adff455835f5afe8492d28d4a119bf238394517b008d206f8e1822bd7f70a83e039140db1ba6b54f5af3614f6805a08ec5caca9b92fcf885a57978bf7b07c1403e54583ff0c5d862f1cef5b3fce7e27ca4c87c88703e45c3fae197526a7464d62ad1001b2:5000:dd5e8e47473d2f4bd5df4a3e3e2e90ba2960e81a5adc48d9f8f2c55df64957a9e8be1fa77aae1bc5c04ec12fbbb943f75e31b05c21194aed843e6507c810aea0612d0d9b99d6cd991312fef958d192991a9f1c9c1f5774ec8d1851d1e19a59aa15be2e36f3b290e7fc760fe29e9ce6f3bcfa7c8890eac463b7694b84390c26375bab30225f1ca8f4336b2c9904c0fba64360d777c03ce2ba0ebef2cce4bcf4fec298f77ba2bdbae1e4e99f5f9b0cbf05f82b77f261d09f22516c98f5095b47f10761a2d6fecfc59cc19aaf42dc4302e48115bf2d51f327ff18c72fbfd5ea2933fd6fbf9cbc354abe3f4c0f51dc3db67b2a07c40110f395ea4aa60e6d2d66e7115e50c6ca045c9bbd411ebb7592e133ef8048a819600ac95e2fd20e4002fcd92a78837f524ddc2b5c3d2ed1ed69f5b2ab38db47123b443610f3a5af0ff2d08a2d6a330f2c4fda7dcd9ab3163a5166cdfcc8385bff3dd1ff625e416f7ddd453c23f0bd965dbbb824145b36c200214c7a1b1d9138e3a4c7fc2e96df8f944a8638990544f859599b27b547c6418370126ee160c8ade4d8416c378903b72def6d7cc3cb470894be6b4c521ac6a2a66af1eb94d0e97a496e50d9dea70381420854ca2e12f8d3dc9517e3ef4f506037cb3098b07170e0d4519ebcd9ef5123e528a9f533a179605c2ce2e7bc1dc98c3ede9375641ae44e775cc3bf4b4cf6400f13e7481c";

		boolean isCorrect = Encryption.validateString(password, encryptedPassword);

		assertTrue("Our encryption algorithm should think this is correct.", isCorrect);
	}
}
